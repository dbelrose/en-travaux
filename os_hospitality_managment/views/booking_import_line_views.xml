<?xml version="1.0" encoding="utf-8"?>
<odoo>
<!--    <record id="view_booking_import_form" model="ir.ui.view">-->
<!--        <field name="name">booking.import.form</field>-->
<!--        <field name="model">booking.import</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <form>-->
<!--                <sheet>-->
<!--                    <group>-->
<!--                        <field name="name" invisible="not name"/>-->
<!--                        <field name="import_date"/>-->
<!--                        <field name="file_name" invisible="name"/>-->
<!--                        <field name="file_data" filename="file_name" invisible="name"/>-->
<!--                        <button name="import_data"-->
<!--                                type="object"-->
<!--                                string="Importer"-->
<!--                                class="btn-primary"-->
<!--                                invisible="not file_name"-->
<!--                        />-->
<!--                    </group>-->
<!--                    <notebook>-->
<!--                        <page string="Lignes importées">-->
<!--                            <field name="line_ids">-->
<!--                                <tree editable="bottom">-->
<!--                                    <field name="arrival_date"/>-->
<!--                                    <field name="duration_nights"/>-->
<!--                                    <field name="pax_nb"/>-->
<!--                                    <field name="children"/>-->
<!--                                    <field name="property_type_id"/>-->
<!--                                    <field name="payment_status"/>-->
<!--                                    <field name="status"/>-->
<!--                                    <field name="partner_id"/>-->
<!--                                    <field name="booker_id"/>-->
<!--                                </tree>-->
<!--                            </field>-->
<!--                        </page>-->
<!--                    </notebook>-->
<!--                </sheet>-->
<!--            </form>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Vue formulaire pour booking.import &ndash;&gt;-->
<!--    <record id="view_booking_management_form" model="ir.ui.view">-->
<!--        <field name="name">booking.management.form</field>-->
<!--        <field name="model">booking.import</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <form string="Importation Booking">-->
<!--                <header>-->
<!--                    <button name="import_data"-->
<!--                            string="Traiter les données"-->
<!--                            type="object"-->
<!--                            class="oe_highlight"-->
<!--                            invisible="file_data == False"/>-->
<!--                    <field name="date" invisible="1"/>-->
<!--                </header>-->
<!--                <sheet>-->
<!--                    <div class="oe_title">-->
<!--                        <h1>-->
<!--                            <field name="name" readonly="1" placeholder="Nom automatique"/>-->
<!--                        </h1>-->
<!--                    </div>-->

<!--                    <group>-->
<!--                        <group string="Informations générales">-->
<!--                            <field name="import_date"  required="1"/>-->
<!--                            <field name="year" readonly="1"/>-->
<!--                            <field name="month" readonly="1"/>-->
<!--                            <field name="property_type_id" domain="[-->
<!--                            ('detailed_type', '=', 'service'),-->
<!--                            ('sale_ok', '=', True)]"/>-->
<!--                        </group>-->
<!--                        <group string="Import de fichier (optionnel)">-->
<!--                            <field name="file_data" filename="file_name"/>-->
<!--                            <field name="file_name" invisible="1"/>-->
<!--                        </group>-->
<!--                    </group>-->

<!--                    <group string="Informations calculées" invisible="not line_ids">-->
<!--                        <group>-->
<!--                            <field name="nom" readonly="1"/>-->
<!--                            <field name="adresse" readonly="1"/>-->
<!--                            <field name="capacite" readonly="1"/>-->
<!--                            <field name="periode" readonly="1"/>-->
<!--                        </group>-->
<!--                        <group>-->
<!--                            <field name="plus_nuitees_trimestre" readonly="1"/>-->
<!--                            <field name="moins_nuitees_trimestre" readonly="1"/>-->
<!--                            <field name="nuitees_trimestre" readonly="1"/>-->
<!--                            <field name="total" readonly="1"/>-->
<!--                            <field name="total_en_toutes_lettres" readonly="1"/>-->
<!--                        </group>-->
<!--                    </group>-->

<!--                    <notebook>-->
<!--                        <page string="Réservations">-->
<!--                            <field name="line_ids">-->
<!--                                <tree editable="bottom">-->
<!--                                    <field name="property_type_id" required="1"/>-->
<!--                                    <field name="booker_id" required="1"/>-->
<!--                                    <field name="partner_id" required="1"/>-->
<!--                                    <field name="arrival_date" required="1"/>-->
<!--                                    <field name="duration_nights" required="1"/>-->
<!--                                    <field name="pax_nb" required="1"/>-->
<!--                                    <field name="children" optional="hide"/>-->
<!--                                    <field name="payment_status" optional="hide"/>-->
<!--                                    <field name="status" optional="hide"/>-->
<!--                                    <field name="rate" optional="hide"/>-->
<!--                                    <field name="commission_amount" optional="hide"/>-->
<!--                                </tree>-->
<!--                                <form string="Détail réservation">-->
<!--                                    <sheet>-->
<!--                                        <group>-->
<!--                                            <group string="Client">-->
<!--                                                <field name="booker_id" required="1"/>-->
<!--                                                <field name="partner_id" required="1"/>-->
<!--                                            </group>-->
<!--                                            <group string="Séjour">-->
<!--                                                <field name="arrival_date" required="1"/>-->
<!--                                                <field name="duration_nights" required="1"/>-->
<!--                                                <field name="pax_nb" required="1"/>-->
<!--                                                <field name="children"/>-->
<!--                                            </group>-->
<!--                                        </group>-->
<!--                                        <group>-->
<!--                                            <group string="Statut">-->
<!--                                                <field name="payment_status"/>-->
<!--                                                <field name="status"/>-->
<!--                                            </group>-->
<!--                                            <group string="Financier" invisible="not rate and not commission_amount">-->
<!--                                                <field name="rate"/>-->
<!--                                                <field name="commission_amount"/>-->
<!--                                            </group>-->
<!--                                        </group>-->
<!--                                    </sheet>-->
<!--                                </form>-->
<!--                            </field>-->
<!--                        </page>-->
<!--                        <page string="Détail nuitées par mois" invisible="not line_ids">-->
<!--                            <group>-->
<!--                                <group string="Mois 1">-->
<!--                                    <field name="plus_nuitees_mois1" readonly="1"/>-->
<!--                                    <field name="moins_nuitees_mois1" readonly="1"/>-->
<!--                                    <field name="nuitees_mois1" readonly="1"/>-->
<!--                                    <field name="total_mois1" readonly="1"/>-->
<!--                                </group>-->
<!--                                <group string="Mois 2">-->
<!--                                    <field name="plus_nuitees_mois2" readonly="1"/>-->
<!--                                    <field name="moins_nuitees_mois2" readonly="1"/>-->
<!--                                    <field name="nuitees_mois2" readonly="1"/>-->
<!--                                    <field name="total_mois2" readonly="1"/>-->
<!--                                </group>-->
<!--                            </group>-->
<!--                            <group>-->
<!--                                <group string="Mois 3">-->
<!--                                    <field name="plus_nuitees_mois3" readonly="1"/>-->
<!--                                    <field name="moins_nuitees_mois3" readonly="1"/>-->
<!--                                    <field name="nuitees_mois3" readonly="1"/>-->
<!--                                    <field name="total_mois3" readonly="1"/>-->
<!--                                </group>-->
<!--                                <group string="Total trimestre">-->
<!--                                    <field name="plus_nuitees_trimestre" readonly="1"/>-->
<!--                                    <field name="moins_nuitees_trimestre" readonly="1"/>-->
<!--                                    <field name="nuitees_trimestre" readonly="1"/>-->
<!--                                    <field name="total" readonly="1"/>-->
<!--                                </group>-->
<!--                            </group>-->
<!--                        </page>-->
<!--                    </notebook>-->
<!--                </sheet>-->
<!--            </form>-->
<!--        </field>-->
<!--    </record>-->

<!--    &lt;!&ndash; Vue liste pour booking.import &ndash;&gt;-->
<!--    <record id="view_booking_import_tree" model="ir.ui.view">-->
<!--        <field name="name">booking.import.tree</field>-->
<!--        <field name="model">booking.import</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <tree string="Importations Booking">-->
<!--                <field name="name"/>-->
<!--                <field name="import_date"/>-->
<!--                <field name="property_type_id"/>-->
<!--                <field name="year"/>-->
<!--                <field name="month"/>-->
<!--                <field name="total_commission" sum="Total Commission"/>-->
<!--                <field name="total"/>-->
<!--                <field name="periode"/>-->
<!--            </tree>-->
<!--        </field>-->
<!--    </record>-->

    <!-- Vue recherche pour booking.import -->
<!--    <record id="view_booking_import_search" model="ir.ui.view">-->
<!--        <field name="name">booking.import.search</field>-->
<!--        <field name="model">booking.import</field>-->
<!--        <field name="arch" type="xml">-->
<!--            <search string="Rechercher importations">-->
<!--                <field name="name"/>-->
<!--                <field name="property_type_id"/>-->
<!--                <field name="year"/>-->
<!--                <field name="month"/>-->
<!--                <field name="periode"/>-->
<!--                <separator/>-->
<!--                <filter string="Cette année" name="current_year"-->
<!--                        domain="[('year', '=', context_today().year)]"/>-->
<!--                <filter string="Année dernière" name="last_year"-->
<!--                        domain="[('year', '=', context_today().year - 1)]"/>-->
<!--                <separator/>-->
<!--                <group expand="0" string="Regrouper par">-->
<!--                    <filter string="Propriété" name="group_property" context="{'group_by': 'property_type_id'}"/>-->
<!--                    <filter string="Année" name="group_year" context="{'group_by': 'year'}"/>-->
<!--                    <filter string="Mois" name="group_month" context="{'group_by': 'month'}"/>-->
<!--                    <filter string="Période" name="group_periode" context="{'group_by': 'periode'}"/>-->
<!--                </group>-->
<!--            </search>-->
<!--        </field>-->
<!--    </record>-->

    <!-- Action pour booking.import -->
<!--    <record id="booking_management_action" model="ir.actions.act_window">-->
<!--        <field name="name">Importations Booking</field>-->
<!--        <field name="res_model">booking.import</field>-->
<!--        <field name="view_mode">form</field>-->
<!--        <field name="view_id" ref="view_booking_management_form"/>-->
<!--        <field name="help" type="html">-->
<!--            <p class="o_view_nocontent_smiling_face">-->
<!--                Créez votre première importation Booking-->
<!--            </p>-->
<!--            <p>-->
<!--                Utilisez cette vue pour saisir manuellement les données de réservation-->
<!--                ou importer un fichier Excel depuis Booking.com.-->
<!--            </p>-->
<!--        </field>-->
<!--    </record>-->

    <!-- Vue formulaire pour booking.import.line -->
    <record id="view_booking_import_line_form" model="ir.ui.view">
        <field name="name">booking.import.line.form</field>
        <field name="model">booking.import.line</field>
        <field name="arch" type="xml">
            <form string="Ligne de réservation">
                <sheet>
                    <group>
                        <group string="Client">
                            <field name="booker_id" required="1"/>
                            <field name="partner_id" required="1"/>
                        </group>
                        <group string="Réservation">
                            <field name="import_id" readonly="1"/>
                            <field name="property_type_id" required="1"/>
                        </group>
                    </group>
                    <group>
                        <group string="Détails du séjour">
                            <field name="arrival_date" required="1"/>
                            <field name="duration_nights" required="1"/>
                            <field name="pax_nb" required="1"/>
                            <field name="children"/>
                        </group>
                        <group string="Statut">
                            <field name="payment_status"/>
                            <field name="status"/>
                        </group>
                    </group>
                    <group string="Informations financières" invisible="not rate and not commission_amount">
                        <group>
                            <field name="rate"/>
                        </group>
                        <group>
                            <field name="commission_amount"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Vue liste pour booking.import.line -->
    <record id="view_booking_import_line_tree" model="ir.ui.view">
        <field name="name">booking.import.line.tree</field>
        <field name="model">booking.import.line</field>
        <field name="arch" type="xml">
            <tree string="Lignes de réservation">
                <field name="import_id"/>
                <field name="booker_id"/>
                <field name="partner_id"/>
                <field name="property_type_id"/>
                <field name="arrival_date"/>
                <field name="duration_nights"/>
                <field name="pax_nb"/>
                <field name="children"/>
                <field name="payment_status"/>
                <field name="status"/>
                <field name="rate" optional="hide" sum="Total Rate"/>
                <field name="commission_amount" optional="hide" sum="Total Commission"/>
            </tree>
        </field>
    </record>

    <!-- Vue recherche pour booking.import.line -->
    <record id="view_booking_import_line_search" model="ir.ui.view">
        <field name="name">booking.import.line.search</field>
        <field name="model">booking.import.line</field>
        <field name="arch" type="xml">
            <search string="Rechercher lignes de réservation">
                <field name="booker_id"/>
                <field name="partner_id"/>
                <field name="property_type_id"/>
                <field name="arrival_date"/>
                <field name="import_id"/>
                <separator/>
                <filter string="Arrivées aujourd'hui" name="arrival_today"
                        domain="[('arrival_date', '&gt;=', context_today()), ('arrival_date', '&lt;', context_today() + datetime.timedelta(days=1))]"/>
                <filter string="Arrivées cette semaine" name="arrival_week"
                        domain="[('arrival_date', '&gt;=', context_today() - datetime.timedelta(days=context_today().weekday())), ('arrival_date', '&lt;', context_today() + datetime.timedelta(days=7-context_today().weekday()))]"/>
                <filter string="Arrivées ce mois" name="arrival_month"
                        domain="[('arrival_date', '&gt;=', context_today().replace(day=1)), ('arrival_date', '&lt;', (context_today().replace(day=1) + datetime.timedelta(days=32)).replace(day=1))]"/>
                <separator/>
                <filter string="Payé entièrement" name="fully_paid"
                        domain="[('payment_status', '=', 'Entièrement payée')]"/>
                <filter string="Statut OK" name="status_ok"
                        domain="[('status', '=', 'ok')]"/>
                <separator/>
                <group expand="0" string="Regrouper par">
                    <filter string="Import" name="group_import" context="{'group_by': 'import_id'}"/>
                    <filter string="Propriété" name="group_property" context="{'group_by': 'property_type_id'}"/>
                    <filter string="Client" name="group_client" context="{'group_by': 'partner_id'}"/>
                    <filter string="Booker" name="group_booker" context="{'group_by': 'booker_id'}"/>
                    <filter string="Date d'arrivée" name="group_arrival" context="{'group_by': 'arrival_date'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Action pour booking.import.line -->
    <record id="action_booking_import_line" model="ir.actions.act_window">
        <field name="name">Lignes de réservation</field>
        <field name="res_model">booking.import.line</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_booking_import_line_tree"/>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Aucune ligne de réservation trouvée
            </p>
            <p>
                Les lignes de réservation sont créées automatiquement lors de l'importation
                ou peuvent être ajoutées manuellement dans le formulaire d'importation.
            </p>
        </field>
    </record>
</odoo>