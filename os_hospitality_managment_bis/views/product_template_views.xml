<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ========================================= -->
    <!-- NOUVELLES VUES POUR LA CONFIGURATION -->
    <!-- ========================================= -->

    <!-- Vue liste des produits de service hospitality -->
    <record id="view_hospitality_service_products_tree" model="ir.ui.view">
        <field name="name">hospitality.service.products.tree</field>
        <field name="model">product.template</field>
        <field name="arch" type="xml">
            <tree string="Produits de service Hospitality" create="true" edit="true" delete="true">
                <field name="default_code"/>
                <field name="name"/>
                <field name="categ_id"/>
                <field name="list_price" widget="monetary"/>
                <field name="property_account_expense_id"/>
                <field name="active"/>
                <button name="action_view_pricelist_rules"
                        string="Listes de prix"
                        type="object"
                        icon="fa-list-alt"
                        class="btn-secondary"/>
            </tree>
        </field>
    </record>

    <!-- Vue formulaire des produits de service hospitality -->
    <record id="view_hospitality_service_products_form" model="ir.ui.view">
        <field name="name">hospitality.service.products.form</field>
        <field name="model">product.template</field>
        <field name="arch" type="xml">
            <form string="Produit de service Hospitality">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Nom du service"/>
                        </h1>
                    </div>

                    <group>
                        <group string="Informations générales">
                            <field name="default_code"/>
                            <field name="categ_id"/>
                            <field name="type" readonly="1"/>
                            <field name="uom_id"/>
                        </group>
                        <group string="Prix et comptabilité">
                            <field name="list_price" widget="monetary"/>
                            <field name="standard_price" widget="monetary"/>
                            <field name="property_account_expense_id"/>
                            <field name="can_be_expensed"/>
                        </group>
                    </group>

                    <group string="Options">
                        <field name="purchase_ok"/>
                        <field name="sale_ok"/>
                        <field name="active"/>
                    </group>

                    <group string="Description">
                        <field name="description" nolabel="1" placeholder="Description du service..."/>
                    </group>

                    <notebook>
                        <page string="Listes de prix" name="pricelists">
                            <!-- Affichage des règles de prix -->
                            <field name="item_ids" context="{'default_product_tmpl_id': active_id}">
                                <tree editable="bottom">
                                    <field name="pricelist_id"/>
                                    <field name="fixed_price" widget="monetary"/>
                                    <field name="date_start"/>
                                    <field name="date_end"/>
                                    <field name="min_quantity"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action pour les produits de service hospitality -->
    <record id="action_hospitality_service_products" model="ir.actions.act_window">
        <field name="name">Produits de service Hospitality</field>
        <field name="res_model">product.template</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('default_code', 'in', ['TAXE_SEJOUR', 'COMMISSION_BOOKING', 'COMMISSION_CONCIERGE'])]</field>
        <field name="context">{
            'default_type': 'service',
            'default_purchase_ok': True,
            'default_sale_ok': False,
            'default_can_be_expensed': True
        }</field>
        <field name="view_id" ref="view_hospitality_service_products_tree"/>
    </record>
</odoo>